services:
  sentry-core:
    image: ghcr.io/ghazeltine/project-sentry:stabilize
    container_name: sentry-core
    restart: unless-stopped
    
    # PRIVILEGES: Required for hardware access
    privileged: true
    cap_add:
      - SYS_ADMIN
      - DAC_READ_SEARCH
    security_opt:
      - apparmor:unconfined
      
    ports:
      - "8000:8000"
      
    environment:
      - SENTRY_USER=${SENTRY_USER:-admin}
      - SENTRY_PASS=${SENTRY_PASS:-change-this-now}
      - SENTRY_DB_PATH=/data/sentry.db
      
    volumes:
      # DATABASE PERSISTENCE
      - /mnt/sentry/_db:/data
      
      # VISIBILITY MAPPINGS
      - /mnt/sentry:/mnt/sentry:shared   # Network Mounts
      - /media:/media:rslave             # USB Drives
      - /mnt:/mnt:rslave                 # Manual Mounts
      - /run/media:/run/media:rslave     # Linux Auto-Mounts
      - /:/host_fs:rslave                # <--- THE KEY: Full Host Access
